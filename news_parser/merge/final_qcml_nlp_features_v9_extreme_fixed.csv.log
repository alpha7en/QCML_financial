2025-04-21 00:55:35,485 - INFO - [<module>:175] - Запуск скрипта слияния и расчета v9 (целевая отладка extreme)...
2025-04-21 00:55:35,486 - INFO - [load_and_prepare_data:86] - [load_and_prepare_data] Загрузка src1 из raw_features.csv...
2025-04-21 00:55:35,505 - INFO - [load_and_prepare_data:89] - [load_and_prepare_data] Загружен файл raw_features.csv, строк: 1431
2025-04-21 00:55:35,512 - INFO - [load_and_prepare_data:111] - [load_and_prepare_data] Парсинг 'news_topic_intensities_1d_raw' для raw_features.csv...
2025-04-21 00:55:35,584 - INFO - [load_and_prepare_data:113] - [load_and_prepare_data] Колонка 'news_topic_intensities_1d_raw' распарсена.
2025-04-21 00:55:35,586 - INFO - [load_and_prepare_data:118] - --- Проверка колонки 'news_sentiment_extreme_rate_1d_raw' в src1 ---
2025-04-21 00:55:35,586 - WARNING - [load_and_prepare_data:151] - Колонка 'news_sentiment_extreme_rate_1d_raw' ОТСУТСТВУЕТ в src1.
2025-04-21 00:55:35,587 - INFO - [load_and_prepare_data:154] - --- Конец проверки 'news_sentiment_extreme_rate_1d_raw' ---
2025-04-21 00:55:35,587 - WARNING - [load_and_prepare_data:160] - [load_and_prepare_data] В raw_features.csv (src1) отсутствуют др. колонки: ['news_sentiment_chg_1d_raw', 'news_topic_focus_shift_1d_raw'].
2025-04-21 00:55:35,590 - INFO - [load_and_prepare_data:169] - [load_and_prepare_data] Подготовка src1 завершена.
2025-04-21 00:55:35,590 - INFO - [load_and_prepare_data:86] - [load_and_prepare_data] Загрузка src2 из gemini_daily_headline_features_structured_v2 (1).csv...
2025-04-21 00:55:35,603 - INFO - [load_and_prepare_data:89] - [load_and_prepare_data] Загружен файл gemini_daily_headline_features_structured_v2 (1).csv, строк: 1826
2025-04-21 00:55:35,607 - INFO - [load_and_prepare_data:118] - --- Проверка колонки 'news_sentiment_extreme_rate_1d_raw' в src2 ---
2025-04-21 00:55:35,608 - WARNING - [load_and_prepare_data:151] - Колонка 'news_sentiment_extreme_rate_1d_raw' ОТСУТСТВУЕТ в src2.
2025-04-21 00:55:35,608 - INFO - [load_and_prepare_data:154] - --- Конец проверки 'news_sentiment_extreme_rate_1d_raw' ---
2025-04-21 00:55:35,611 - INFO - [load_and_prepare_data:169] - [load_and_prepare_data] Подготовка src2 завершена.
2025-04-21 00:55:35,611 - INFO - [<module>:183] - Слияние данных по дате...
2025-04-21 00:55:35,616 - INFO - [<module>:187] - Слияние завершено. Строк: 1828.
2025-04-21 00:55:35,617 - INFO - [<module>:190] - Создание комбинированных сырых признаков...
2025-04-21 00:55:35,617 - INFO - [combine_cols:197] - [combine_cols] 'combined_sentiment_1d_raw': используется стратегия 'mean' для ['news_sentiment_1d_raw_src1', 'news_sentiment_1d_raw_src2'].
2025-04-21 00:55:35,619 - INFO - [combine_cols:197] - [combine_cols] 'combined_sentiment_extreme_rate_1d_raw': используется стратегия 'prefer_src1' для ['news_sentiment_extreme_rate_1d_raw_src1', 'news_sentiment_extreme_rate_1d_raw_src2'].
2025-04-21 00:55:35,621 - INFO - [combine_cols:197] - [combine_cols] 'combined_topic_entropy_1d_raw': используется стратегия 'mean' для ['news_topic_entropy_1d_raw_src1', 'news_topic_entropy_1d_raw_src2'].
2025-04-21 00:55:35,623 - INFO - [combine_cols:197] - [combine_cols] 'combined_news_topic_intensity_MacroRF_raw': используется стратегия 'mean' для ['news_topic_intensity_MacroRF_raw_src1', 'news_topic_intensity_MacroRF_raw_src2'].
2025-04-21 00:55:35,625 - INFO - [combine_cols:197] - [combine_cols] 'combined_news_topic_intensity_MonetaryPolicyRF_raw': используется стратегия 'mean' для ['news_topic_intensity_MonetaryPolicyRF_raw_src1', 'news_topic_intensity_MonetaryPolicyRF_raw_src2'].
2025-04-21 00:55:35,627 - INFO - [combine_cols:197] - [combine_cols] 'combined_news_topic_intensity_GeopoliticsSanctions_raw': используется стратегия 'mean' для ['news_topic_intensity_GeopoliticsSanctions_raw_src1', 'news_topic_intensity_GeopoliticsSanctions_raw_src2'].
2025-04-21 00:55:35,629 - INFO - [combine_cols:197] - [combine_cols] 'combined_news_topic_intensity_OilGasEnergy_raw': используется стратегия 'mean' для ['news_topic_intensity_OilGasEnergy_raw_src1', 'news_topic_intensity_OilGasEnergy_raw_src2'].
2025-04-21 00:55:35,631 - INFO - [combine_cols:197] - [combine_cols] 'combined_news_topic_intensity_FiscalPolicyCorp_raw': используется стратегия 'mean' для ['news_topic_intensity_FiscalPolicyCorp_raw_src1', 'news_topic_intensity_FiscalPolicyCorp_raw_src2'].
2025-04-21 00:55:35,633 - INFO - [<module>:230] - Комбинированные сырые признаки созданы. Проверка NaN:
2025-04-21 00:55:35,634 - INFO - [<module>:235] -   - combined_sentiment_1d_raw: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,634 - INFO - [<module>:235] -   - combined_sentiment_chg_1d_raw: NaN = 14/1828 (0.8%)
2025-04-21 00:55:35,634 - INFO - [<module>:235] -   - combined_sentiment_extreme_rate_1d_raw: NaN = 1828/1828 (100.0%)
2025-04-21 00:55:35,637 - INFO - [<module>:238] -     -> Статистика для combined_sentiment_extreme_rate_1d_raw:
count    0.0
mean     NaN
std      NaN
min      NaN
25%      NaN
50%      NaN
75%      NaN
max      NaN
2025-04-21 00:55:35,638 - INFO - [<module>:235] -   - combined_topic_focus_shift_1d_raw: NaN = 14/1828 (0.8%)
2025-04-21 00:55:35,638 - INFO - [<module>:235] -   - combined_topic_entropy_1d_raw: NaN = 3/1828 (0.2%)
2025-04-21 00:55:35,639 - INFO - [<module>:235] -   - combined_news_topic_intensity_MacroRF_raw: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,639 - INFO - [<module>:235] -   - combined_news_topic_intensity_MonetaryPolicyRF_raw: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,639 - INFO - [<module>:235] -   - combined_news_topic_intensity_GeopoliticsSanctions_raw: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,639 - INFO - [<module>:235] -   - combined_news_topic_intensity_OilGasEnergy_raw: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,640 - INFO - [<module>:235] -   - combined_news_topic_intensity_FiscalPolicyCorp_raw: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,640 - INFO - [<module>:246] - Начало расчета финальных 12 признаков...
2025-04-21 00:55:35,641 - INFO - [calculate_and_log:261] -   Расчет: news_sentiment_accel_1d_z21 из 'sentiment_accel'
2025-04-21 00:55:35,644 - INFO - [calculate_and_log:267] -     -> Результат для news_sentiment_accel_1d_z21: NaN=20/1828
2025-04-21 00:55:35,644 - INFO - [calculate_and_log:261] -   Расчет: news_topic_entropy_daily_z21 из 'combined_topic_entropy_1d_raw'
2025-04-21 00:55:35,647 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_entropy_daily_z21: NaN=3/1828
2025-04-21 00:55:35,647 - INFO - [<module>:275] - --- Расчет news_sentiment_extreme_1d_z21 ---
2025-04-21 00:55:35,647 - WARNING - [calculate_and_log:260] -   Пропуск: news_sentiment_extreme_1d_z21 (вход 'combined_sentiment_extreme_rate_1d_raw' вся NaN)
2025-04-21 00:55:35,648 - INFO - [<module>:277] - --- Конец расчета news_sentiment_extreme_1d_z21 ---
2025-04-21 00:55:35,648 - INFO - [calculate_and_log:261] -   Расчет: news_topic_shock_1d_z21 из 'combined_topic_focus_shift_1d_raw'
2025-04-21 00:55:35,650 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_shock_1d_z21: NaN=14/1828
2025-04-21 00:55:35,651 - INFO - [calculate_and_log:261] -   Расчет: news_topic_intensity_MacroRF_1d_z21 из 'combined_news_topic_intensity_MacroRF_raw'
2025-04-21 00:55:35,653 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_intensity_MacroRF_1d_z21: NaN=0/1828
2025-04-21 00:55:35,653 - INFO - [calculate_and_log:261] -   Расчет: news_topic_intensity_MonPolicy_1d_z21 из 'combined_news_topic_intensity_MonetaryPolicyRF_raw'
2025-04-21 00:55:35,656 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_intensity_MonPolicy_1d_z21: NaN=0/1828
2025-04-21 00:55:35,656 - INFO - [calculate_and_log:261] -   Расчет: news_topic_intensity_Geopol_1d_z21 из 'combined_news_topic_intensity_GeopoliticsSanctions_raw'
2025-04-21 00:55:35,659 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_intensity_Geopol_1d_z21: NaN=0/1828
2025-04-21 00:55:35,659 - INFO - [calculate_and_log:261] -   Расчет: news_sentiment_level_21d_z63 из 'sentiment_level_21d'
2025-04-21 00:55:35,662 - INFO - [calculate_and_log:267] -     -> Результат для news_sentiment_level_21d_z63: NaN=14/1828
2025-04-21 00:55:35,662 - INFO - [calculate_and_log:261] -   Расчет: news_topic_entropy_level_21d_z63 из 'entropy_level_21d'
2025-04-21 00:55:35,665 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_entropy_level_21d_z63: NaN=14/1828
2025-04-21 00:55:35,666 - INFO - [calculate_and_log:261] -   Расчет: news_topic_intensity_OilGas_21d_z63 из 'intensity_OilGas_level_21d'
2025-04-21 00:55:35,668 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_intensity_OilGas_21d_z63: NaN=14/1828
2025-04-21 00:55:35,669 - INFO - [calculate_and_log:261] -   Расчет: news_topic_intensity_Fiscal_21d_z63 из 'intensity_Fiscal_level_21d'
2025-04-21 00:55:35,671 - INFO - [calculate_and_log:267] -     -> Результат для news_topic_intensity_Fiscal_21d_z63: NaN=14/1828
2025-04-21 00:55:35,672 - INFO - [calculate_and_log:261] -   Расчет: news_sentiment_level_63d_z1y из 'sentiment_level_63d'
2025-04-21 00:55:35,674 - INFO - [calculate_and_log:267] -     -> Результат для news_sentiment_level_63d_z1y: NaN=46/1828
2025-04-21 00:55:35,675 - INFO - [<module>:295] - Расчет финальных признаков завершен. Проверка NaN в результатах:
2025-04-21 00:55:35,675 - INFO - [<module>:297] -   - news_sentiment_accel_1d_z21: NaN = 20/1828 (1.1%)
2025-04-21 00:55:35,675 - INFO - [<module>:297] -   - news_topic_entropy_daily_z21: NaN = 3/1828 (0.2%)
2025-04-21 00:55:35,676 - INFO - [<module>:297] -   - news_sentiment_extreme_1d_z21: NaN = 1828/1828 (100.0%)
2025-04-21 00:55:35,676 - INFO - [<module>:297] -   - news_topic_shock_1d_z21: NaN = 14/1828 (0.8%)
2025-04-21 00:55:35,677 - INFO - [<module>:297] -   - news_topic_intensity_MacroRF_1d_z21: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,677 - INFO - [<module>:297] -   - news_topic_intensity_MonPolicy_1d_z21: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,678 - INFO - [<module>:297] -   - news_topic_intensity_Geopol_1d_z21: NaN = 0/1828 (0.0%)
2025-04-21 00:55:35,678 - INFO - [<module>:297] -   - news_sentiment_level_21d_z63: NaN = 14/1828 (0.8%)
2025-04-21 00:55:35,678 - INFO - [<module>:297] -   - news_topic_entropy_level_21d_z63: NaN = 14/1828 (0.8%)
2025-04-21 00:55:35,679 - INFO - [<module>:297] -   - news_topic_intensity_OilGas_21d_z63: NaN = 14/1828 (0.8%)
2025-04-21 00:55:35,679 - INFO - [<module>:297] -   - news_topic_intensity_Fiscal_21d_z63: NaN = 14/1828 (0.8%)
2025-04-21 00:55:35,680 - INFO - [<module>:297] -   - news_sentiment_level_63d_z1y: NaN = 46/1828 (2.5%)
2025-04-21 00:55:35,682 - INFO - [<module>:308] - Сохранение итогового файла (1828 строк) в final_qcml_nlp_features_v9_extreme_fixed.csv...
2025-04-21 00:55:35,741 - INFO - [<module>:313] - Файл с финальными 12 признаками успешно сохранен.
2025-04-21 00:55:35,742 - INFO - [<module>:316] - Скрипт завершил выполнение.
